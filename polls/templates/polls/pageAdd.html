{%extends './tpl.html'%}
{%block content%}
<div class="head">
  <h3 class="title">添加文章</h3>
</div>
<div class="form">
  <form action="" enctype="multipart/form-data">
    {%csrf_token%}
    <div class="item">
      <label for="">标题:</label>
      <input type="text" name="title" value="">
    </div>
    <div class="item">
      <label for="">作者:</label>
      <input type="text" name="author" value="">
    </div>
    <div class="item">
      <label for="">缩略图:</label>
      <input type="file" name="thumb" value="">
    </div>
    <div class="item">
      <label for="">简介:</label>
      <textarea name="info" cols="30" rows="10"></textarea>
    </div>
    <div class="item">
      <label for="">内容:</label>
      <textarea name="content" cols="30" rows="10"></textarea>
    </div>
    <div class="item">
      <input type="button" class="submit" value="添加">
      <a href="/polls/cateIndex">返回</a>
    </div>
  </form>
</div>
{%endblock%}

{%block js%}
<script>
  $(function(){
    $('.submit').on('click', function(){
      $.ajax({
        type:"POST",
        url:"/polls/pageAdds",
        cache: false,
        contentType:false,
        processData: false,
        data: new FormData($('form')[0]),
        success: function(data){
          if(data.status==1){
            alert(data.info);
            window.location.href=data.url;
          }else{
            alert(data.info);
          }
        }
      })
    });
  })
</script>
{%endblock%}
